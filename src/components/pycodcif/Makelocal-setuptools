PYTHON_DIST_PATH = lib/python2.7/dist-packages

VERSION := $(shell grep -v "^\#" ../../../.version)

EGG_DIR = pycodcif-${VERSION}.egg-info

.PHONY: all build install

all: build

build: ${TEST_MODULE} ${TEST_DEPEND}

${TEST_MODULE} ${TEST_DEPEND}:
	python setup.py build
	python setup.py install --root .
	ln -s usr/local/${PYTHON_DIST_PATH}/pycodcif/_pycodcif.so

echo:
	echo ${TEST_MODULE} ${TEST_DEPEND}

install:
	mkdir --parents ${PREFIX}/${PYTHON_DIST_PATH}/pycodcif
	mkdir --parents ${PREFIX}/${PYTHON_DIST_PATH}/${EGG_DIR}
	install usr/local/${PYTHON_DIST_PATH}/pycodcif/*.so ${PREFIX}/${PYTHON_DIST_PATH}/pycodcif
	install --mode 644 usr/local/${PYTHON_DIST_PATH}/pycodcif/*.py ${PREFIX}/${PYTHON_DIST_PATH}/pycodcif
	install --mode 644 usr/local/${PYTHON_DIST_PATH}/${EGG_DIR}/*  ${PREFIX}/${PYTHON_DIST_PATH}/${EGG_DIR}

clean:
	rm  -f pycodcif_wrap.c
	rm -rf build pycodcif.egg-info

distclean cleanAll: clean
	rm -rf usr pycodcif.py _pycodcif.so
