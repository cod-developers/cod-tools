#! /bin/sh
#!perl -w # --*- Perl -*--
eval 'exec perl -x $0 ${1+"$@"}'
    if 0;
#------------------------------------------------------------------------------
#$Author: saulius $
#$Date: 2007-02-04 20:26:13 +0200 (Sun, 04 Feb 2007) $ 
#$Revision: 71 $
#$URL: svn+ssh://kolibris.ibt.lt/home/saulius/svn-repositories/cif-tools/trunk/cif_parse $
#------------------------------------------------------------------------------
#*
#  Parse a CIF file
#**

use strict;
use lib "./lib/perl5";
use lib "./CIFParser";
use CIFParser;
use ShowStruct;

my $filename = shift(@ARGV);

my $parser = new CIFParser;

my $data = $parser->Run($filename);


for my $dataset (@$data) {
    my $values = $dataset->{values};

    next unless defined $values;
    next unless defined $values->{_name};

    my @name = @{$values->{_name}};
    my ( $inlist, $list_mandatory ) = ( 0, 0 );
    if( defined $values->{_list} ) {
	if( $values->{_list}[0] eq "yes" ) {
	    $inlist = 1;
	} elsif( $values->{_list}[0] eq "both" ) {
	    $inlist = 2;
	}
    }
    if( defined $values->{_list_mandatory} and
	$values->{_list_mandatory}[0] eq "yes" ) {
	$list_mandatory = 1;
    }
    for my $name (@name) {
	print "$inlist\t$list_mandatory\t$name\n";
    }
}
